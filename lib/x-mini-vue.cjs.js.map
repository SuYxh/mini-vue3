{"version":3,"file":"x-mini-vue.cjs.js","sources":["../src/shared/index.ts","../src/reactivity/effect.ts","../src/reactivity/baseHandlers.ts","../src/reactivity/reactive.ts","../src/runtime-core/componentPublicInstance.ts","../src/runtime-core/componentProps.ts","../src/runtime-core/componentEmit.ts","../src/runtime-core/componentSlots.ts","../src/runtime-core/component.ts","../src/runtime-core/vnode.ts","../src/runtime-core/renderer.ts","../src/runtime-core/createApp.ts","../src/runtime-core/h.ts","../src/runtime-core/helpers/renderSlots.ts"],"sourcesContent":["export const extend = Object.assign;\n\nexport const isObject = (value) => {\n  return value !== null && typeof value === \"object\";\n};\n\nexport const hasChanged = (val, newValue) => {\n  return !Object.is(val, newValue);\n};\n\nexport const hasOwn = (val, key) =>\n  Object.prototype.hasOwnProperty.call(val, key);\n\nexport const camelize = (str: string) => {\n  return str.replace(/-(\\w)/g, (_, c: string) => {\n    return c ? c.toUpperCase() : \"\";\n  });\n};\n\nconst capitalize = (str: string) => {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n};\n\nexport const toHandlerKey = (str: string) => {\n  return str ? \"on\" + capitalize(str) : \"\";\n};\n","import { extend } from \"../shared\";\n\nlet activeEffect\nlet shouldTrack\nexport class ReactiveEffect {\n  private _fn: any\n  deps = [];\n  active = true;\n  onStop?: () => void;\n  public scheduler: Function | undefined;\n  constructor(fn, scheduler?: Function) {\n    this._fn = fn\n    this.scheduler = scheduler\n  }\n\n  run() {\n    // 调用 stop 后 this.active 变为了 false， shouldTrack 为 false，在 track 方法就不会在收集到依赖\n    if (!this.active) {\n      return this._fn();\n    }\n\n    // 应该收集\n    shouldTrack = true;\n    // 保存一下当前的 activeEffect\n    activeEffect = this;\n    const r = this._fn();\n\n    // 重置\n    shouldTrack = false;\n\n    return r;\n  }\n\n  stop() {\n    if (this.active) {\n      cleanupEffect(this);\n      if (this.onStop) {\n        this.onStop();\n      }\n      this.active = false;\n    }\n  }\n}\n\nfunction cleanupEffect(effect) {\n  effect.deps.forEach((dep: any) => {\n    dep.delete(effect);\n  });\n\n  effect.deps.length = 0\n}\n\n// targetMap 为什么要是全局的？\n// 如果 targetMap 不是全局的，只是在 track 方法中定义，那么在 trigger 中就无法获取到 targetMap\nconst targetMap = new Map()\nexport function track(target, key) {\n  // 如果没有这句话就会报错，为什么会有这句话呢？ activeEffect 什么时候不存在？\n  // 当只有用户写了 effect 函数的时候，才会有\n  // if (!activeEffect) return;\n  // if (!shouldTrack) return\n\n  // 将上面2 行代码进行优化\n  if (!isTracking()) return\n\n  // 我们在运行时，可能会创建多个 target，每个 target 还会可能有多个 key，每个 key 又关联着多个 effectFn\n  // 而且 target -> key -> effectFn，这三者是树形的关系\n  // 因此就可以创建一个 Map 用于保存 target，取出来就是每个 key 对应这一个 depsMap，而每个 depsMap 又是一个 Set\n  // 使用 set 结构（避免保存重复的 effect）\n  let depsMap = targetMap.get(target)\n  if (!depsMap) {\n    depsMap = new Map()\n    targetMap.set(target, depsMap)\n  }\n\n  let dep = depsMap.get(key)\n  if (!dep) {\n    dep = new Set()\n    depsMap.set(key, dep)\n  }\n\n  trackEffects(dep)\n}\n\n// 抽离函数\nexport function trackEffects(dep) {\n  // 看看 dep 之前有没有添加过，添加过的话 那么就不添加了\n  if (dep.has(activeEffect)) return\n\n  activeEffect.deps.push(dep)\n  dep.add(activeEffect)\n}\nexport function isTracking() {\n  return shouldTrack && activeEffect !== undefined;\n}\n\nexport function trigger(target, key) {\n  // trigger 的逻辑就更加简单了，我们只需要取出depsMap中 key 对应的 dep， 这个 dep 是 一个 set 结构，再遍历 set 执行每个 effect 就可以了\n  const depsMap = targetMap.get(target)\n  const dep = depsMap.get(key)\n  triggerEffects(dep)\n}\n\nexport function triggerEffects(deps) {\n  for (const effect of deps) {\n    if (effect.scheduler) {\n      effect.scheduler()\n    } else {\n      effect.run()\n    }\n  }\n}\n\nexport function effect(fn, options:any = {}) {\n  const _effect = new ReactiveEffect(fn, options.scheduler)\n  extend(_effect, options);\n\n  _effect.run()\n\n  const runner: any = _effect.run.bind(_effect)\n  runner.effect = _effect;\n\n  return runner\n}\n\nexport function stop(runner) {\n  runner.effect.stop();\n}","import { extend, isObject } from \"../shared\";\nimport { track, trigger } from \"./effect\"\nimport { reactive, ReactiveFlags, readonly } from \"./reactive\";\n\n// \nconst get = createGetter()\nconst readonlyGet = createGetter(true)\nconst set = createSetter()\nconst shallowReadonlyGet = createGetter(true, true);\nconst shallowMutableGet = createGetter(false, true)\n\nfunction createGetter(isReadonly = false, shallow = false) {\n  return function get(target, key, receiver) {\n    if (key === ReactiveFlags.IS_REACTIVE) {\n      return !isReadonly;\n    } else if (key === ReactiveFlags.IS_READONLY) {\n      return isReadonly;\n    } else if (key === ReactiveFlags.RAW) {\n      // 判断一下，如果访问的 key 是 ReactiveFlag.RAW，就直接返回就可以了\n      return target\n    }\n\n    const res = Reflect.get(target, key, receiver)\n\n    if (shallow) {\n      return res;\n    }\n\n    if (isObject(res)) {\n      return isReadonly ? readonly(res) : reactive(res);\n    }\n\n    // readonly 的对象不会被 track\n    if (!isReadonly) {\n      track(target, key)\n    }\n    return res\n  }\n}\n\n\nfunction createSetter() {\n  return function set(target, key, val, receiver) {\n    const res = Reflect.set(target, key, val, receiver)\n    trigger(target, key)\n    return res\n  }\n}\n\n\n// mutable 可变的\nexport const mutableHandlers = {\n  // 这里不需要每次都调用 createGetter 这个方法，所以缓存一下，初始化的时候调用一次就好\n  // get: createGetter(),\n  // set: createSetter(),\n  get,\n  set,\n}\n\nexport const readonlyHandlers = {\n  get: readonlyGet,\n  // readonly 的属性值不可更改，set 中直接返回 true 即可\n  set(target, key, value) {\n    // 在这里警告\n    console.warn(\n      `key: ${key} set value: ${value} fail, because the target is readonly`,\n      target\n    )\n    return true\n  },\n}\n\nexport const shallowReadonlyHandlers = extend({}, readonlyHandlers, {\n  get: shallowReadonlyGet,\n});\n\nexport const shalloReactiveHandlers = extend({}, mutableHandlers, {\n  get: shallowMutableGet,\n})","import { mutableHandlers, readonlyHandlers, shallowReadonlyHandlers, shalloReactiveHandlers } from './baseHandlers';\n\nexport const enum ReactiveFlags {\n  IS_REACTIVE = \"__v_isReactive\",\n  IS_READONLY = \"__v_isReadonly\",\n  RAW = '__v_raw',\n}\n\nfunction createReactiveObject(raw, baseHandlers) {\n  return new Proxy(raw, baseHandlers)\n}\n\nexport function reactive(raw) {\n  return createReactiveObject(raw, mutableHandlers)\n}\n\n// 1、readonly 的对象不会被 track，\n// 2、readonly 的属性值不可更改，set 中直接返回 true 即可\nexport function readonly(raw) {\n  return createReactiveObject(raw, readonlyHandlers)\n}\n\nexport function shallowReadonly(raw) {\n  return createReactiveObject(raw, shallowReadonlyHandlers);\n}\n\nexport function shallowReactive(raw) {\n  return createReactiveObject(raw, shalloReactiveHandlers)\n}\n\nexport function isReactive(value) {\n  // 如果 value 是一个响应式对象， 在 value 身上进行取值，就会触发 getter，在 getter 中进行了判断，返回了 true\n  // 如果 value 不是一个响应式对象，value[ReactiveFlags.IS_REACTIVE] 的值为 undefined， 转成 boolean 也就是 false\n  return !!value[ReactiveFlags.IS_REACTIVE];\n}\n\nexport function isReadonly(value) {\n  return !!value[ReactiveFlags.IS_READONLY];\n}\n\nexport function isProxy(value) {\n  return isReactive(value) || isReadonly(value);\n}\n\nexport function toRaw(observed) {\n  // 这里就是嵌套转换了\n  const original = observed && observed[ReactiveFlags.RAW]\n  return isProxy(original) ? toRaw(original) : original\n}","import { hasOwn } from \"../shared/index\";\n\nconst publicPropertiesMap = {\n  $el: (i) => i.vnode.el,\n  $slots: (i) => i.slots,\n};\n\nexport const PublicInstanceProxyHandlers = {\n  get({ _: instance }, key) {\n    const { setupState, props } = instance;\n\n    if (hasOwn(setupState, key)) {\n      return setupState[key];\n    } else if (hasOwn(props, key)) {\n      return props[key];\n    }\n\n    const publicGetter = publicPropertiesMap[key];\n    if (publicGetter) {\n      return publicGetter(instance);\n    }\n  },\n};\n","export function initProps(instance, rawProps) {\n  instance.props = rawProps || {}\n}\n","import { camelize, toHandlerKey } from \"../shared/index\";\n\nexport function emit(instance, event, ...args) {\n  const { props } = instance;\n  const handlerName = toHandlerKey(camelize(event));\n  const handler = props[handlerName];\n  handler && handler(...args);\n}\n","import { ShapeFlags } from \"../shared/ShapeFlags\";\n\nexport function initSlots(instance, children) {\n  // 插槽的不同形式对应的 children 不同，如下：\n  // 1、h(Foo, {}, h('p', {}, '123')); ==> children:  {\"type\":\"p\",\"props\":{},\"children\":\"123\",\"shapeFlag\":5,\"el\":null}\n  // 2、h(Foo, {}, [h('p', {}, '123'), h('p', {}, '234')]); ==> children: [{\"type\":\"p\",\"props\":{},\"children\":\"123\",\"shapeFlag\":5,\"el\":null},{\"type\":\"p\",\"props\":{},\"children\":\"234\",\"shapeFlag\":5,\"el\":null}]\n  // 3、 const foo = h(Foo, {}, { header: ({age}) => h('p', {}, 'header' + age), footer: () => h('p', {}, 'footer'), }); 其 children 形式如下：\n  //    children: ==>\n  //      {\n  //        footer :  () => h('p', {}, 'footer')\n  //        header :  ({age}) => h('p', {}, 'header' + age)\n  //      } \n\n  const { vnode } = instance;\n  // 是插槽的时候才需要处理\n  if (vnode.shapeFlag & ShapeFlags.SLOT_CHILDREN) {\n    // 如果 children 存在 shapeFlag 属性，说明他是一个 vnode，此时用户应该是这样使用插槽的：\n    // h(Foo, {}, h('p', {}, '123'));\n    if (children.shapeFlag) {\n      instance.slots.default = [children]\n      return\n    }\n\n    // 如果 children 是一个数组，此时用户应该是这样使用插槽的：\n    // h(Foo, {}, [h('p', {}, '123'), h('p', {}, '234')]);\n    // children 的形式为： [{\"type\":\"p\",\"props\":{},\"children\":\"123\",\"shapeFlag\":5,\"el\":null},{\"type\":\"p\",\"props\":{},\"children\":\"234\",\"shapeFlag\":5,\"el\":null}]\n    if (Array.isArray(children)) {\n      instance.slots.default = children\n      return\n    }\n\n    // 到这里说明 children 是一个对象，用户应该是使用的 具名插槽或者是作用域插槽\n    // 具体形式请看上方注释 《插槽的不同形式对应的 children 不同》\n    normalizeObjectSlots(children, instance.slots);\n  }\n}\n\nfunction normalizeObjectSlots(children: any, slots: any) {\n  for (const key in children) {\n    const value = children[key]\n    // 具名插槽\n    /**\n     * 具名插槽 对应的使用方式\n     * const foo = h(Foo, {}, {\n        header:  h('p', {}, 'header'),\n        footer:  h('p', {}, 'footer'),\n      });\n\n      其实 normalizeSlotValue(value); 中的 value 就是 h('p', {}, 'header') \n     */\n    // slots[key] = normalizeSlotValue(value);\n    // 作用域插槽使用函数\n\n     /**\n     * 作用域插槽对应的使用方式\n     * const foo = h(Foo, {}, {\n        header: ({age}) => h('p', {}, 'header' + age),\n        footer: () => h('p', {}, 'footer'),\n      });\n\n      其实 slots[key] = (props) => normalizeSlotValue(value(props)); 中的 value(props) 就是 header 或者 footer 对应的函数\n     */\n    slots[key] = (props) => normalizeSlotValue(value(props));\n  }\n}\n\nfunction normalizeSlotValue(value) {\n  return Array.isArray(value) ? value : [value];\n}\n","import { shallowReadonly } from \"../reactivity/reactive\";\nimport { PublicInstanceProxyHandlers } from \"./componentPublicInstance\";\nimport { initProps } from \"./componentProps\";\nimport { emit } from \"./componentEmit\";\nimport { initSlots } from \"./componentSlots\";\n\nexport function createComponentInstance(vnode) {\n  const component = {\n    vnode,\n    type: vnode.type,\n    setupState: {},\n    props: {},\n    slots: {},\n    emit: () => {},\n  };\n\n  component.emit = emit.bind(null, component) as any;\n\n  return component;\n}\n\nexport function setupComponent(instance) {\n  initProps(instance, instance.vnode.props);\n  initSlots(instance, instance.vnode.children);\n  setupStatefulComponent(instance);\n}\n\nfunction setupStatefulComponent(instance: any) {\n  const Component = instance.type;\n\n  // 在这里对于 instance 的 this 进行拦截\n  instance.proxy = new Proxy({ _: instance }, PublicInstanceProxyHandlers);\n\n  const { setup } = Component;\n\n  if (setup) {\n    const setupResult = setup(shallowReadonly(instance.props), {\n      emit: instance.emit,\n    });\n\n    handleSetupResult(instance, setupResult);\n  }\n}\n\nfunction handleSetupResult(instance, setupResult: any) {\n  // function Object\n  // TODO function\n  if (typeof setupResult === \"object\") {\n    instance.setupState = setupResult;\n  }\n\n  finishComponentSetup(instance);\n}\n\nfunction finishComponentSetup(instance: any) {\n  const Component = instance.type;\n\n  if (Component.render) {\n    instance.render = Component.render;\n  }\n}\n","import { ShapeFlags } from \"../shared/ShapeFlags\";\nexport const Fragment = Symbol(\"Fragment\");\nexport const Text = Symbol(\"Text\");\n\nexport function createVNode(type, props?, children?) {\n  const vnode = {\n    type,\n    props,\n    children,\n    shapeFlag: getShapeFlag(type),\n    el: null,\n  };\n\n  if (typeof children === \"string\") {\n    vnode.shapeFlag |= ShapeFlags.TEXT_CHILDREN;\n  } else if (Array.isArray(children)) {\n    vnode.shapeFlag |= ShapeFlags.ARRAY_CHILDREN;\n  }\n\n  // 条件： 组件 + children 是一个对象\n  if(vnode.shapeFlag & ShapeFlags.STATEFUL_COMPONENT){\n    if(typeof children === \"object\"){\n      vnode.shapeFlag |= ShapeFlags.SLOT_CHILDREN\n    }\n  }\n\n\n  return vnode;\n}\n\nexport function createTextVNode(text: string) {\n  return createVNode(Text, {}, text);\n}\n\nfunction getShapeFlag(type) {\n  return typeof type === \"string\"\n    ? ShapeFlags.ELEMENT\n    : ShapeFlags.STATEFUL_COMPONENT;\n}\n","import { ShapeFlags } from \"../shared/ShapeFlags\";\nimport { createComponentInstance, setupComponent } from \"./component\";\nimport { Fragment, Text } from \"./vnode\";\n\nexport function render(vnode, container) {\n  patch(vnode, container);\n}\n\nfunction patch(vnode, container) {\n  const { type, shapeFlag } = vnode;\n\n  switch (type) {\n    case Fragment:\n      processFragment(vnode, container);\n      break;\n    case Text:\n      processText(vnode, container);\n      break;\n\n    default:\n      if (shapeFlag & ShapeFlags.ELEMENT) {\n        // 如果这里的条件成立，说明 shapeFlag 包含 ELEMENT 标志\n        processElement(vnode, container);\n      } else if (shapeFlag & ShapeFlags.STATEFUL_COMPONENT) {\n        processComponent(vnode, container);\n      }\n      break;\n  }\n}\n\nfunction processText(vnode: any, container: any) {\n  const { children } = vnode;\n  const textNode = (vnode.el = document.createTextNode(children));\n  container.append(textNode);\n}\n\nfunction processFragment(vnode: any, container: any) {\n  mountChildren(vnode, container);\n}\n\nfunction processElement(vnode: any, container: any) {\n  mountElement(vnode, container);\n}\n\nfunction mountElement(vnode: any, container: any) {\n  const el = document.createElement(vnode.type);\n  vnode.el = el\n\n  const { children, shapeFlag } = vnode;\n\n  // children\n  if (shapeFlag & ShapeFlags.TEXT_CHILDREN) {\n    el.textContent = children;\n  } else if (shapeFlag & ShapeFlags.ARRAY_CHILDREN) {\n    mountChildren(vnode, el);\n  }\n\n  // props\n  const { props } = vnode;\n  for (const key in props) {\n    const val = props[key];\n    const isOn = (key: string) => /^on[A-Z]/.test(key);\n    if (isOn(key)) {\n      const event = key.slice(2).toLowerCase();\n      el.addEventListener(event, val);\n    } else {\n      el.setAttribute(key, val);\n    }\n  }\n\n  container.append(el);\n}\n\nfunction mountChildren(vnode, container) {\n  vnode.children.forEach((v) => {\n    patch(v, container);\n  });\n}\n\nfunction processComponent(vnode: any, container: any) {\n  mountComponent(vnode, container);\n}\n\nfunction mountComponent(vnode: any, container) {\n  const instance = createComponentInstance(vnode);\n\n  setupComponent(instance);\n  setupRenderEffect(instance, container);\n}\n\nfunction setupRenderEffect(instance: any, container) {\n  // 进行代理\n  const { proxy } = instance;\n  const subTree = instance.render.call(proxy);\n  patch(subTree, container)\n\n  instance.el = subTree.el;\n}\n","import { render } from \"./renderer\";\nimport { createVNode } from \"./vnode\";\n\nexport function createApp(rootComponent) {\n  return {\n    mount(rootContainer) {\n      const vnode = createVNode(rootComponent);\n\n      render(vnode, rootContainer);\n    },\n  };\n}\n","import { createVNode } from \"./vnode\";\n\nexport function h(type, props?, children?) {\n  return createVNode(type, props, children);\n}\n","import { createVNode, Fragment } from \"../vnode\";\n\nexport function renderSlots(slots, name = 'default', props) {\n  const slot = slots[name]\n\n  if (slot) {\n    if (typeof slot === \"function\") {\n      // 说明用户使用的是具名插槽或者作用域插槽\n      return createVNode(Fragment, {}, slot(props));\n    }else if (Array.isArray(slot)) {\n      // 说明用户使用的是普通插槽\n      return createVNode(Fragment, {}, slot);\n    }\n  }\n}\n"],"names":[],"mappings":"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"}